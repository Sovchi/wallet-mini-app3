<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Wallet MiniApp3</title>
    <script src="https://cdn.jsdelivr.net/npm/@tonconnect/sdk@1.2.0/dist/tonconnect.umd.js"></script>
</head>
<body>
    <h2>Wallet MiniApp3</h2>
    <button id="connect">Connect TON</button>

    <script>
        // Перевірка WebApp API
        if (!window.Telegram?.WebApp) {
            alert("Open this Mini App inside Telegram mobile app!");
        }

        const tg = window.Telegram.WebApp;
        tg.expand();

        const tonConnect = new TonConnect({
            manifestUrl: "https://sovchi.github.io/wallet-mini-app3/tonconnect-manifest.json"
        });

        document.getElementById("connect").onclick = async () => {
            try {
                const wallet = await tonConnect.connect();
                console.log(wallet);

                // Надсилаємо адресу боту
                tg.sendData(JSON.stringify({
                    address: wallet.account.address,
                    chain: wallet.account.chain
                }));

                alert("Wallet connected: " + wallet.account.address);
            } catch (e) {
                console.error(e);
                alert("Failed to connect wallet");
            }
        };
    </script>
</body>
</html>

